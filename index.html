<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TrainLog MVP</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* --- –°–¢–ò–õ–ò (–í–Ω–µ—à–Ω–∏–π –≤–∏–¥) --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--tg-theme-bg-color, #212121); /* –¶–≤–µ—Ç —Ñ–æ–Ω–∞ –∏–∑ –¢–ì */
            color: var(--tg-theme-text-color, #ffffff); /* –¶–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∏–∑ –¢–ì */
            margin: 0; padding: 15px;
            display: flex; flex-direction: column; align-items: center;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∞ - –±–µ–ª—ã–π –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–ª–æ–∫ */
        .card {
            background: rgba(255, 255, 255, 0.08); /* –ß—É—Ç—å —Å–≤–µ—Ç–ª–µ–µ —Ñ–æ–Ω–∞ */
            padding: 20px; 
            border-radius: 16px;
            width: 100%; 
            box-sizing: border-box; /* –ß—Ç–æ–±—ã –æ—Ç—Å—Ç—É–ø—ã –Ω–µ –ª–æ–º–∞–ª–∏ —à–∏—Ä–∏–Ω—É */
            margin-bottom: 15px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
        input {
            width: 100%; 
            padding: 12px; 
            margin: 8px 0;
            box-sizing: border-box;
            border-radius: 10px; 
            border: 1px solid #444;
            background: var(--tg-theme-secondary-bg-color, #333); 
            color: var(--tg-theme-text-color, #fff);
            font-size: 16px;
        }

        /* –ì–ª–∞–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ */
        .main-btn {
            width: 100%; 
            padding: 14px;
            margin-top: 10px;
            background-color: var(--tg-theme-button-color, #3390ec);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none; 
            border-radius: 10px; 
            font-size: 16px; font-weight: 600;
            cursor: pointer;
        }
        
        .main-btn:active { transform: scale(0.98); opacity: 0.9; }

        /* –≠–ª–µ–º–µ–Ω—Ç –∏—Å—Ç–æ—Ä–∏–∏ */
        .history-item {
            display: flex; justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            text-align: left;
            font-size: 14px;
        }
        .history-item:last-child { border-bottom: none; }
        .date { font-size: 12px; opacity: 0.6; }

        /* –ü–µ—Ä—Å–æ–Ω–∞–∂ */
        #char-visual { font-size: 60px; margin: 10px 0; display: block; }
    </style>
</head>
<body>

    <div class="card">
        <div id="char-visual">üê£</div>
        <h2 id="status-text">–ù–æ–≤–∏—á–æ–∫</h2>
        <p style="opacity: 0.7; margin: 5px 0;">–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫: <b id="train-count">0</b></p>
    </div>

    <div class="card">
        <h3 style="margin-top: 0;">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥</h3>
        <input type="text" id="exercise-input" placeholder="–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ (–Ω–∞–ø—Ä. –ñ–∏–º)">
        <div style="display: flex; gap: 10px;">
            <input type="number" id="weight-input" placeholder="–í–µ—Å (–∫–≥)">
            <input type="number" id="reps-input" placeholder="–ü–æ–≤—Ç–æ—Ä—ã">
        </div>
        <button class="main-btn" onclick="saveData()">–ó–∞–ø–∏—Å–∞—Ç—å</button>
        <button class="main-btn" onclick="clearData()" style="background-color: #ff4d4d; margin-top: 10px; font-size: 12px;">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å (–¢–µ—Å—Ç)</button>
    </div>

    <div class="card">
        <h3 style="margin-top: 0; text-align: left;">–ò—Å—Ç–æ—Ä–∏—è (–ü–æ—Å–ª–µ–¥–Ω–∏–µ 5)</h3>
        <div id="history-list">
            <p style="opacity: 0.5; font-size: 14px;">–ü–æ–∫–∞ –ø—É—Å—Ç–æ...</p>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand(); // –ù–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω

        // --- –õ–û–ì–ò–ö–ê ---
        
        // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–∞–º—è—Ç–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        // "train_log_v1" - —ç—Ç–æ –∫–ª—é—á (–∫–∞–∫ –∏–º—è –ø–∞–ø–∫–∏), –≥–¥–µ –º—ã —Ö—Ä–∞–Ω–∏–º –¥–∞–Ω–Ω—ã–µ
        let savedData = localStorage.getItem('train_log_v1');
        let workouts = savedData ? JSON.parse(savedData) : [];

        // –°—Ä–∞–∑—É –æ–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –±—ã–ª–∏
        renderInterface();

        // 2. –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–æ–π)
        function saveData() {
            // –ë–µ—Ä–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–æ–ª–µ–π
            let exercise = document.getElementById('exercise-input').value;
            let weight = document.getElementById('weight-input').value;
            let reps = document.getElementById('reps-input').value;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å–ª–∏ –ø—É—Å—Ç–æ, —Ä—É–≥–∞–µ–º—Å—è
            if(!exercise || !weight || !reps) {
                tg.showAlert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!");
                return;
            }

            // –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
            let newRecord = {
                id: Date.now(), // —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä (–≤—Ä–µ–º—è)
                name: exercise,
                w: weight,
                r: reps,
                date: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            };

            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–∞—á–∞–ª–æ —Å–ø–∏—Å–∫–∞
            workouts.unshift(newRecord);

            // –°–û–•–†–ê–ù–Ø–ï–ú –í –ü–ê–ú–Ø–¢–¨ (–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ!)
            localStorage.setItem('train_log_v1', JSON.stringify(workouts));

            // –í–∏–±—Ä–∞—Ü–∏—è —É—Å–ø–µ—Ö–∞
            tg.HapticFeedback.notificationOccurred('success');

            // –ß–∏—Å—Ç–∏–º –ø–æ–ª—è –∏ –æ–±–Ω–æ–≤–ª—è–µ–º —ç–∫—Ä–∞–Ω
            document.getElementById('exercise-input').value = "";
            document.getElementById('weight-input').value = "";
            document.getElementById('reps-input').value = "";
            
            renderInterface();
        }

        // 3. –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ (–æ–±–Ω–æ–≤–ª—è–µ—Ç —ç–∫—Ä–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö)
        function renderInterface() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
            let count = workouts.length;
            document.getElementById('train-count').innerText = count;

            // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–ü—Ä–æ—Å—Ç–∞—è)
            let char = "üê£";
            let title = "–ù–æ–≤–∏—á–æ–∫";
            
            if (count >= 5) { char = "üê•"; title = "–õ—é–±–∏—Ç–µ–ª—å"; }
            if (count >= 15) { char = "üêì"; title = "–û–ø—ã—Ç–Ω—ã–π"; }
            if (count >= 30) { char = "ü¶ñ"; title = "–ú–æ–Ω—Å—Ç—Ä"; }

            document.getElementById('char-visual').innerText = char;
            document.getElementById('status-text').innerText = title;

            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏
            let historyHTML = "";
            // –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π
            workouts.slice(0, 5).forEach(item => {
                historyHTML += `
                    <div class="history-item">
                        <div><b>${item.name}</b></div>
                        <div>${item.w}–∫–≥ √ó ${item.r} <span class="date">(${item.date})</span></div>
                    </div>
                `;
            });

            if(workouts.length > 0) {
                document.getElementById('history-list').innerHTML = historyHTML;
            } else {
                document.getElementById('history-list').innerHTML = '<p style="opacity: 0.5;">–ü–æ–∫–∞ –ø—É—Å—Ç–æ...</p>';
            }
        }

        // 4. –§—É–Ω–∫—Ü–∏—è —Å–±—Ä–æ—Å–∞ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)
        function clearData() {
            tg.showConfirm("–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å—Å?", function(ok) {
                if(ok) {
                    localStorage.removeItem('train_log_v1');
                    workouts = [];
                    renderInterface();
                }
            });
        }

    </script>
</body>
</html>